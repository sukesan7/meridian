name: ci
on: [push, pull_request]

permissions:
    contents: read

concurrency:
    group: ${{ github.workflow }}-${{ github.ref }}
    cancel-in-progress: true

jobs:
    test:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                python-version: ["3.10", "3.11"]
        steps:
            - uses: actions/checkout@v4

            - uses: actions/setup-python@v5
              with:
                  python-version: ${{ matrix.python-version }}
                  cache: "pip"

            - run: python -m pip install --upgrade pip
            - run: pip install -e ".[dev]"

            - name: Pre-commit (ruff/format/etc.)
              run: pre-commit run --all-files --show-diff-on-failure

            - name: Pytest
              run: pytest -q
